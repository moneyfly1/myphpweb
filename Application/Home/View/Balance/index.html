<extend name="Public:layout" />
<block name="title">我的余额</block>
<block name="content">
<div class="home-page">
    <div class="page-header">
        <h2>我的余额</h2>
        <p>查看账户余额和交易记录</p>
    </div>

    <div style="background:linear-gradient(135deg,#1677ff 0%,#0958d9 100%);border-radius:12px;padding:32px;color:#fff;text-align:center;margin-bottom:20px;">
        <div style="font-size:0.95rem;opacity:0.85;">账户余额 (元)</div>
        <div style="font-size:2.5rem;font-weight:700;margin:8px 0;letter-spacing:-1px;">{$balance}</div>
        <a href="{:U('Home/Balance/recharge')}" style="display:inline-block;margin-top:12px;padding:8px 28px;background:rgba(255,255,255,0.2);color:#fff;border:1px solid rgba(255,255,255,0.4);border-radius:8px;font-size:1rem;font-weight:500;text-decoration:none;transition:all .2s;"><i class="fas fa-plus-circle"></i> 充值</a>
    </div>

    <div class="home-card">
        <h3><i class="fas fa-list"></i> 交易记录</h3>
        <notempty name="records">
        <!-- 桌面端表格 -->
        <div class="home-desktop-table" style="overflow-x:auto;">
            <table class="home-table">
                <thead>
                    <tr>
                        <th>时间</th>
                        <th>类型</th>
                        <th>金额</th>
                        <th>余额</th>
                        <th>备注</th>
                    </tr>
                </thead>
                <tbody>
                    <volist name="records" id="vo">
                    <tr>
                        <td>{$vo.create_time_fmt}</td>
                        <td>
                            <?php
                            $typeMap = [1=>'充值',2=>'消费',3=>'退款',4=>'调整',5=>'邀请奖励'];
                            $classMap = [1=>'type-recharge',2=>'type-consume',3=>'type-refund',4=>'type-adjust',5=>'type-invite'];
                            $t = $vo['type'];
                            ?>
                            <span class="home-badge <?php echo isset($classMap[$t])?$classMap[$t]:''; ?>"><?php echo isset($typeMap[$t])?$typeMap[$t]:'其他'; ?></span>
                        </td>
                        <td>
                            <if condition="$vo['type'] eq 2">
                                <span style="color:#e53e3e;font-weight:600;">{$vo.amount_fmt}</span>
                            <else />
                                <span style="color:#38a169;font-weight:600;">{$vo.amount_fmt}</span>
                            </if>
                        </td>
                        <td>{$vo.balance_after}</td>
                        <td>{$vo.remark|default='-'}</td>
                    </tr>
                    </volist>
                </tbody>
            </table>
        </div>
        <!-- 移动端卡片 -->
        <div class="home-mobile-cards">
            <volist name="records" id="vo">
            <div class="home-m-card">
                <div class="m-card-header">
                    <span class="m-card-title">{$vo.create_time_fmt}</span>
                    <?php
                    $t = $vo['type'];
                    ?>
                    <span class="home-badge <?php echo isset($classMap[$t])?$classMap[$t]:''; ?>"><?php echo isset($typeMap[$t])?$typeMap[$t]:'其他'; ?></span>
                </div>
                <div class="m-card-row">
                    <span class="m-label">金额</span>
                    <span class="m-value">
                        <if condition="$vo['type'] eq 2">
                            <span style="color:#e53e3e;font-weight:600;">{$vo.amount_fmt}</span>
                        <else />
                            <span style="color:#38a169;font-weight:600;">{$vo.amount_fmt}</span>
                        </if>
                    </span>
                </div>
                <div class="m-card-row">
                    <span class="m-label">余额</span>
                    <span class="m-value">{$vo.balance_after}</span>
                </div>
                <div class="m-card-row">
                    <span class="m-label">备注</span>
                    <span class="m-value">{$vo.remark|default='-'}</span>
                </div>
            </div>
            </volist>
        </div>
        <else />
        <div class="home-empty">暂无交易记录</div>
        </notempty>
    </div>
</div>
</block>
<block name="head">
<style>
    .type-recharge { background:rgba(22,119,255,.12); color:#1677ff; }
    .type-consume { background:rgba(245,108,108,.12); color:#e53e3e; }
    .type-refund { background:rgba(250,173,20,.12); color:#d48806; }
    .type-adjust { background:rgba(114,46,209,.12); color:#722ed1; }
    .type-invite { background:rgba(72,199,142,.12); color:#38a169; }
</style>
</block>
