<extend name="Public:layout" />
<block name="title">我的工单</block>
<block name="head">
<style>
    .status-tag { display:inline-block; padding:3px 10px; border-radius:9999px; font-size:12px; font-weight:500; }
    .status-0 { background:rgba(237,137,54,.12); color:#ed8936; }
    .status-1 { background:rgba(66,153,225,.12); color:#4299e1; }
    .status-2 { background:rgba(72,187,120,.12); color:#48bb78; }
    .status-3 { background:rgba(160,174,192,.12); color:#a0aec0; }
    .ticket-card { display:block; background:var(--color-bg); border-radius:12px; box-shadow:0 1px 3px rgba(0,0,0,.08); padding:20px 24px; margin-bottom:14px; text-decoration:none; color:inherit; transition:all .2s; border:1px solid rgba(0,0,0,.06); }
    .ticket-card:hover { box-shadow:0 4px 12px rgba(0,0,0,.1); transform:translateY(-2px); }
    .ticket-card-top { display:flex; justify-content:space-between; align-items:center; margin-bottom:10px; }
    .ticket-card-no { font-size:12px; color:var(--color-text-placeholder); font-family:monospace; }
    .ticket-card-title { font-size:16px; font-weight:600; margin-bottom:8px; color:var(--color-text); }
    .ticket-card-bottom { display:flex; justify-content:space-between; align-items:center; font-size:13px; color:var(--color-text-placeholder); }
    .btn-create { display:inline-flex; align-items:center; gap:8px; padding:10px 24px; background:var(--color-primary); color:#fff; border-radius:8px; text-decoration:none; font-weight:600; font-size:14px; transition:all .2s; }
    .btn-create:hover { opacity:.85; color:#fff; text-decoration:none; }
    @media (max-width:767px) { .ticket-card { padding:14px 16px; } .btn-create { padding:12px 20px; font-size:15px; } }
</style>
</block>
<block name="content">
    <div class="home-page">
        <div class="page-header" style="display:flex;justify-content:space-between;align-items:center;">
            <h2>我的工单</h2>
            <a href="{:U('Home/Ticket/create')}" class="btn-create"><i class="fas fa-plus"></i> 提交工单</a>
        </div>
        <foreach name="list" item="v">
        <a href="{:U('Home/Ticket/detail', array('id'=>$v['id']))}" class="ticket-card">
            <div class="ticket-card-top">
                <span class="ticket-card-no">{$v['ticket_no']}</span>
                <if condition="$v['status'] eq 0"><span class="status-tag status-0">待处理</span>
                <elseif condition="$v['status'] eq 1" /><span class="status-tag status-1">处理中</span>
                <elseif condition="$v['status'] eq 2" /><span class="status-tag status-2">已回复</span>
                <else /><span class="status-tag status-3">已关闭</span>
                </if>
            </div>
            <div class="ticket-card-title">{$v['title']}</div>
            <div class="ticket-card-bottom">
                <span>创建于 {$v['created_at']|date='Y-m-d H:i',###}</span>
                <if condition="$v['updated_at']">
                <span>最后更新 {$v['updated_at']|date='Y-m-d H:i',###}</span>
                </if>
            </div>
        </a>
        </foreach>
        <if condition="empty($list)">
        <div class="home-empty">
            <i class="fas fa-ticket-alt"></i>
            <p>暂无工单，点击上方按钮提交新工单</p>
        </div>
        </if>
    </div>
</block>
